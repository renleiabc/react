(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{30:function(e,t,n){"use strict";var a={fields:["id","title","author","vote","updatedAt"],limit:10,order:"updatedAt DESC",include:"authorPointer",includefilter:{user:{fields:["id","username"]}}};function r(e){return encodeURIComponent(JSON.stringify(e))}t.a={login:function(){return"/user/login"},getPostList:function(){return"/post?filter=".concat(r(a))},getPostById:function(e){return"/post?filter=".concat(r(function(e){return{fields:["id","title","author","vote","updatedAt","content"],where:{id:e},include:"authorPointer",includefilter:{user:{fields:["id","username"]}}}}(e)))},createPost:function(){return"/post"},updatePost:function(e){return"/post/".concat(e)},getCommentList:function(e){return"/comment?filter=".concat(r(function(e){return{fields:["id","author","updatedAt","content"],where:{post:e},limit:20,order:"updatedAt DESC",include:"authorPointer",includefilter:{user:{fields:["id","username"]}}}}(e)))},createComment:function(){return"/comment"}}},31:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return s});var a=Date.now(),r=function(e){function t(e,t){return e<<t|e>>>32-t}function n(e){var t,n="";for(t=7;t>=0;t--)n+=(e>>>4*t&15).toString(16);return n}var a,r,o,c,i,s,l,u,h,d=new Array(80),m=1732584193,f=4023233417,p=2562383102,C=271733878,v=3285377520,b=(e=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var a=e.charCodeAt(n);a<128?t+=String.fromCharCode(a):a>127&&a<2048?(t+=String.fromCharCode(a>>6|192),t+=String.fromCharCode(63&a|128)):(t+=String.fromCharCode(a>>12|224),t+=String.fromCharCode(a>>6&63|128),t+=String.fromCharCode(63&a|128))}return t}(e)).length,g=new Array;for(r=0;r<b-3;r+=4)o=e.charCodeAt(r)<<24|e.charCodeAt(r+1)<<16|e.charCodeAt(r+2)<<8|e.charCodeAt(r+3),g.push(o);switch(b%4){case 0:r=2147483648;break;case 1:r=e.charCodeAt(b-1)<<24|8388608;break;case 2:r=e.charCodeAt(b-2)<<24|e.charCodeAt(b-1)<<16|32768;break;case 3:r=e.charCodeAt(b-3)<<24|e.charCodeAt(b-2)<<16|e.charCodeAt(b-1)<<8|128}for(g.push(r);g.length%16!=14;)g.push(0);for(g.push(b>>>29),g.push(b<<3&4294967295),a=0;a<g.length;a+=16){for(r=0;r<16;r++)d[r]=g[a+r];for(r=16;r<=79;r++)d[r]=t(d[r-3]^d[r-8]^d[r-14]^d[r-16],1);for(c=m,i=f,s=p,l=C,u=v,r=0;r<=19;r++)h=t(c,5)+(i&s|~i&l)+u+d[r]+1518500249&4294967295,u=l,l=s,s=t(i,30),i=c,c=h;for(r=20;r<=39;r++)h=t(c,5)+(i^s^l)+u+d[r]+1859775393&4294967295,u=l,l=s,s=t(i,30),i=c,c=h;for(r=40;r<=59;r++)h=t(c,5)+(i&s|i&l|s&l)+u+d[r]+2400959708&4294967295,u=l,l=s,s=t(i,30),i=c,c=h;for(r=60;r<=79;r++)h=t(c,5)+(i^s^l)+u+d[r]+3395469782&4294967295,u=l,l=s,s=t(i,30),i=c,c=h;m=m+c&4294967295,f=f+i&4294967295,p=p+s&4294967295,C=C+l&4294967295,v=v+u&4294967295}return(h=n(m)+n(f)+n(p)+n(C)+n(v)).toLowerCase()}("A6053788184630UZ8B3F5860-2646-2C47-DC50-39106919B260UZ"+a)+"."+a,o=new Headers({"X-APICloud-AppId":"A6053788184630","X-APICloud-AppKey":r,Accept:"application/json","Content-Type":"application/json"});function c(e){return fetch(e,{method:"GET",headers:o}).then(function(t){return l(e,t)}).catch(function(t){return console.error("Request failed. Url = ".concat(e," . Message = ").concat(t)),{error:{message:"Request failed."}}})}function i(e,t){return fetch(e,{method:"POST",headers:o,body:JSON.stringify(t)}).then(function(t){return l(e,t)}).catch(function(t){return console.error("Request failed. Url = ".concat(e," . Message = ").concat(t)),{error:{message:"Request failed."}}})}function s(e,t){return fetch(e,{method:"PUT",headers:o,body:JSON.stringify(t)}).then(function(t){return l(e,t)}).catch(function(t){return console.error("Request failed. Url = ".concat(e," . Message = ").concat(t)),{error:{message:"Request failed."}}})}function l(e,t){return t.status<500?t.json():(console.error("Request failed. Url = ".concat(e," . Message = ").concat(t.statusText)),{error:{message:"Request failed due to server error "}})}},32:function(e,t,n){"use strict";function a(e){var t=new Date(e),n=t.getFullYear(),a=t.getMonth()+1+"";a=1===a.length?"0"+a:a;var r=t.getDate()+"";r=1===r.length?"0"+r:r;var o=t.getHours()+"";o=1===o.length?"0"+o:o;var c=t.getMinutes()+"";return c=1===c.length?"0"+c:c,"".concat(n,"-").concat(a,"-").concat(r," ").concat(o,":").concat(c)}n.d(t,"a",function(){return a})},33:function(e,t,n){"use strict";var a=n(5),r=n(6),o=n(8),c=n(7),i=n(9),s=n(12),l=n(1),u=n.n(l),h=function(e){function t(e){var n;Object(a.a)(this,t);var r=(n=Object(o.a)(this,Object(c.a)(t).call(this,e))).props.post;return n.state={title:r&&r.title||"",content:r&&r.content||""},n.handleCancelClick=n.handleCancelClick.bind(Object(s.a)(Object(s.a)(n))),n.handleSaveClick=n.handleSaveClick.bind(Object(s.a)(Object(s.a)(n))),n.handleChange=n.handleChange.bind(Object(s.a)(Object(s.a)(n))),n}return Object(i.a)(t,e),Object(r.a)(t,[{key:"handleChange",value:function(e){var t=e.target.name;"title"===t?this.setState({title:e.target.value}):"content"===t?this.setState({content:e.target.value}):console.log("do nothing")}},{key:"handleSaveClick",value:function(){var e={title:this.state.title,content:this.state.content};this.props.onSave(e)}},{key:"handleCancelClick",value:function(){this.props.onCancel()}},{key:"render",value:function(){return u.a.createElement("div",{className:"postEditor"},u.a.createElement("input",{type:"text",name:"title",value:this.state.title,onChange:this.handleChange}),u.a.createElement("textarea",{name:"content",placeholder:"\u5185\u5bb9",value:this.state.contnet,onChange:this.handleChange}),u.a.createElement("button",{onClick:this.handleCancelClick},"\u53d6\u6d88"),u.a.createElement("button",{onClick:this.handleSaveClick,className:"editor-save"},"\u4fdd\u5b58"))}}]),t}(l.Component);t.a=h},34:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABzUlEQVRYR+2XQU7CUBCGZ4otKw3uTLQENtquxBPIDcQTqDfQE4gnUG6AJxBPIJ5AdkU3GoqJO4Gd7wljWorQvrapQh8xsds2M9/88978U4QlP7jk/PD3AaytlTIqeOMoSSM6NLufzZ+oOrcCVl6rIsD5OCn1sgNeLPaglxRifgBdbSLi/jQhnRkdfiUNoK2rLUDc/U5IcGvYrCIF4GlTLY0y+DCbjIjuTZuXpQBYulpHxKOlAIRV7x5DGQo85yD3saY50hcEqUdUM7r8NNUWWMLJn6ZDGh7u2MNGKgBO5WxVvSTE46gExFjRfIOXXwE4U01RlJk7PQ6jDVjNGS5tXWsAwkFccASoxr2fxJp84xtE0dKOh0uc9EkrhsAZ8QP4xurMbAO4MDusuhCAwKCSDkBeMeEtkKBA8JbIVyBwS3wAj3qmQphxvd03Xhd2BqhvdHhuNrZfAXe5UO5SAwhxSrkAIO4KUgGUIe1tv/JWZAs8k3lPpwVi/508wkrWzmuUBgARXZs2FzxEJsCJafN6sDhpANkBWw/blkWA4JLpbDneHEjihqGmFLOohgCEWa7nhhtQANXdAwXLjnZD6hPjpagdYe7/gsQ2HPHhP8AXr5kcMA++kXUAAAAASUVORK5CYII="},35:function(e,t,n){"use strict";function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){a(e,t,n[t])})}return e}n.d(t,"a",function(){return r})},36:function(e,t,n){},38:function(e,t,n){},40:function(e,t,n){},42:function(e,t,n){},45:function(e,t,n){"use strict";n.r(t);var a=n(35),r=n(5),o=n(6),c=n(8),i=n(7),s=n(9),l=n(12),u=n(1),h=n.n(u),d=n(33),m=n(32),f=(n(36),n(34)),p=n.n(f);var C=function(e){console.log(e);var t=e.post,n=e.editable,a=e.onEditClick;return h.a.createElement("div",{className:"postView"},h.a.createElement("div",null,h.a.createElement("h2",null,t.title),h.a.createElement("div",{className:"mark"},h.a.createElement("span",{className:"author"},t.author.username),h.a.createElement("span",null,"\xb7"),h.a.createElement("span",null,Object(m.a)(t.updatedAt)),n?h.a.createElement("span",null,"\xb7",h.a.createElement("button",{onClick:a},"\u7f16\u8f91")):null),h.a.createElement("div",{className:"content"},t.content)),h.a.createElement("div",{className:"vote"},h.a.createElement("span",null,h.a.createElement("img",{alt:"vote",src:p.a})),h.a.createElement("span",null,t.vote)))},v=(n(38),function(e){function t(){return Object(r.a)(this,t),Object(c.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(s.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props.comments;return console.log(e),h.a.createElement("ul",{className:"commentsView"},e.map(function(e){return console.log(e.author),h.a.createElement("li",{key:e.id},h.a.createElement("div",null,e.content),h.a.createElement("div",{className:"sub"},e.author?h.a.createElement("span",null,e.author.username):h.a.createElement("span",null,"\u533f\u540d"),h.a.createElement("span",null,"\u2022"),h.a.createElement("span",null,Object(m.a)(e.updatedAt))))}))}}]),t}(u.Component)),b=(n(40),function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(c.a)(this,Object(i.a)(t).call(this,e))).state={value:""},n.handleChange=n.handleChange.bind(Object(l.a)(Object(l.a)(n))),n.handleClick=n.handleClick.bind(Object(l.a)(Object(l.a)(n))),n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"handleChange",value:function(e){this.setState({value:e.target.value})}},{key:"handleClick",value:function(e){this.state.value.length>0?(this.props.onSubmit(this.state.value),this.setState({value:""})):alert("\u8bc4\u8bba\u5185\u5bb9\u4e0d\u80fd\u4e3a\u7a7a\uff01 ")}},{key:"render",value:function(){var e=this.props,t=e.comments,n=e.editable;return h.a.createElement("div",{className:"commentList"},h.a.createElement("div",{className:"title"},h.a.createElement("div",{className:"comments"},"\u8bc4\u8bba"),n?h.a.createElement("div",{className:"editor"},h.a.createElement("textarea",{placeholder:"\u8bf4\u8bf4\u4f60\u7684\u770b\u6cd5",value:this.state.value,onChange:this.handleChange}),h.a.createElement("button",{onClick:this.handleClick},"\u63d0\u4ea4")):null,h.a.createElement(v,{comments:t})))}}]),t}(u.Component)),g=n(31),O=n(30),A=(n(42),function(e){function t(e){var n;return Object(r.a)(this,t),(n=Object(c.a)(this,Object(i.a)(t).call(this,e))).state={post:null,comments:[],editing:!1},n.handleEditClick=n.handleEditClick.bind(Object(l.a)(Object(l.a)(n))),n.handleCommentSubmit=n.handleCommentSubmit.bind(Object(l.a)(Object(l.a)(n))),n.handlePostSave=n.handlePostSave.bind(Object(l.a)(Object(l.a)(n))),n.handlePostCnacel=n.handlePostCnacel.bind(Object(l.a)(Object(l.a)(n))),n.refreshCommments=n.refreshCommments.bind(Object(l.a)(Object(l.a)(n))),n.refreshPost=n.refreshPost.bind(Object(l.a)(Object(l.a)(n))),n}return Object(s.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.refreshCommments(),this.refreshPost()}},{key:"refreshPost",value:function(){var e=this,t=this.props.match.params.id;Object(g.a)(O.a.getPostById(t)).then(function(t){t.error||1!==t.length||e.setState({post:t[0]})})}},{key:"refreshCommments",value:function(){var e=this,t=this.props.match.params.id;Object(g.a)(O.a.getCommentList(t)).then(function(t){t.error||e.setState({comments:t})})}},{key:"handleEditClick",value:function(){this.setState({editing:!0})}},{key:"handlePostSave",value:function(e){var t=this.props.match.params.id;this.savePost(t,e)}},{key:"handlePostCnacel",value:function(){this.setState({editing:!1})}},{key:"handleCommentSubmit",value:function(e){var t=this.props.match.params.id,n={author:this.props.userId,post:t,content:e};this.saveComment(n)}},{key:"saveComment",value:function(e){var t=this;Object(g.b)(O.a.createComment(),e).then(function(e){e.error||t.refreshCommments()})}},{key:"savePost",value:function(e,t){var n=this;Object(g.c)(O.a.updatePost(e),t).then(function(e){if(!e.error){var t=Object(a.a)({},e,{author:n.state.post.author});n.setState({post:t,editing:!1})}})}},{key:"render",value:function(){var e=this.state,t=e.post,n=e.comments,a=e.editing;console.log(t);var r=this.props.userId;if(!t)return null;var o=r===t.author.id;return h.a.createElement("div",{className:"post"},a?h.a.createElement(d.a,{post:t,onSave:this.handlePostSave,onCancel:this.handlePostCnacel}):h.a.createElement(C,{post:t,editable:o,onEditClick:this.handleEditClick}),h.a.createElement(b,{comments:n,editable:Boolean(r),onSubmit:this.handleCommentSubmit}))}}]),t}(u.Component));t.default=A}}]);
//# sourceMappingURL=3.48b95c8f.chunk.js.map